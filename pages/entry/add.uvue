<template>
	<scroll-view class="page" scroll-y="true">
		
		<view class="form-card">
			<view class="card-header-line">
				<view class="blue-bar"></view>
				<text class="header-text">å…¥åº“æ¥æº</text>
			</view>
			<view class="grid-container">
				<view class="grid-cell" style="width: 100%;">
					<text class="field-label">é€‰æ‹©ä¾›åº”å•†</text>
					<view class="row-center">
						<picker mode="selector" :range="contactNames" @change="onContactChange" class="flex-1">
							<view class="input-box picker-layout">
								<text class="input-val" :class="form['supplier_id']!='0'?'text-dark':'text-light'">{{ currentContactName }}</text>
								<text class="icon-arrow">â–¼</text>
							</view>
						</picker>
						<view class="add-btn" @click="showAddModal=true">+</view>
					</view>
				</view>
			</view>
		</view>

		<view class="form-card">
			<view class="card-header-line">
				<view class="orange-bar"></view>
				<text class="header-text">å•†å“è¯¦æƒ…</text>
			</view>
			
			<view class="grid-container mb-3" style="flex-wrap: wrap;">
				<view v-for="(item, index) in types" :key="index" class="type-cell" @click="changeCategory(item['key'])" style="min-width: 30%; margin-bottom: 10rpx;">
					<view class="type-btn" :class="form['category'] == item['key'] ? 'btn-active' : 'btn-normal'">
						<text class="type-text" :class="form['category'] == item['key'] ? 'text-white' : 'text-gray'">{{ item['name'] }}</text>
					</view>
				</view>
			</view>
			
			<view class="upload-box" @click="chooseImage">
				<image v-if="previewUrl" :src="previewUrl" mode="aspectFill" class="upload-img"></image>
				<view v-else class="upload-placeholder">
					<text class="camera-icon">ğŸ“·</text>
					<text class="camera-text">ç‚¹å‡»æ‹æ‘„/ä¸Šä¼ å›¾ç‰‡</text>
				</view>
			</view>

			<view class="grid-container mb-3 bg-blue-light p-2 rounded">
				<view class="grid-cell">
					<text class="field-label text-blue">å…¥åº“æ•°é‡</text>
					<input class="input-box font-bold" type="number" v-model="form['quantity']" placeholder="1" />
				</view>
				<view class="grid-cell" style="align-items: center;">
					<text class="field-label text-blue">å¿…é¡»åºåˆ—å·?</text>
					<switch :checked="form['need_sn']" @change="onSnChange" color="#2563eb" style="transform:scale(0.8)"/>
				</view>
			</view>
			<view class="tip-text text-gray mb-3" style="text-align: center; font-size: 24rpx;">
				{{ form['need_sn'] ? 'âš ï¸ ç”Ÿæˆâ€œå¾…å…¥åº“â€çŠ¶æ€ï¼Œéœ€åç»­æ‰«ç è½¬æ­£' : 'âœ… ç›´æ¥ç”Ÿæˆâ€œåœ¨åº“â€çŠ¶æ€ï¼Œè‡ªåŠ¨äº§ç”Ÿæµæ°´å·' }}
			</view>

			<view class="sn-box">
				<text class="field-label" style="color: #b45309;">ğŸ”¢ åºåˆ—å·/IMEI/SNç  ({{ form['need_sn'] ? 'å¿…å¡«' : 'é€‰å¡«/åŸºç¡€ç ' }})</text>
				<view class="sn-input-wrapper">
					<input class="sn-input" v-model="form['sn']" :placeholder="snPlaceholder" />
					<view class="scan-btn" @click="scanCode">æ‰«</view>
				</view>
			</view>
			
			<view v-if="['ZJ', 'PH', 'TB', 'XS'].includes(form['category'])">
				<view class="grid-container mt-2">
					<view class="grid-cell">
						<text class="field-label">{{ labelCPU }}</text>
						<input class="input-box" v-model="form['cpu']" :placeholder="phCPU" @input="autoName" />
					</view>
					<view class="grid-cell">
						<text class="field-label">{{ labelGPU }}</text>
						<input class="input-box" v-model="form['gpu']" :placeholder="phGPU" @input="autoName" />
					</view>
				</view>
				<view class="grid-container mt-2">
					<view class="grid-cell">
						<text class="field-label">{{ labelRAM }}</text>
						<input class="input-box" v-model="form['ram']" :placeholder="phRAM" @input="autoName" />
					</view>
					<view class="grid-cell">
						<text class="field-label">{{ labelDISK }}</text>
						<input class="input-box" v-model="form['disk']" :placeholder="phDISK" @input="autoName" />
					</view>
				</view>
				<view class="grid-container mt-2">
					<view class="grid-cell" style="width: 100%;">
						<text class="field-label">å¤‡æ³¨ / æˆè‰²</text>
						<input class="input-box" v-model="form['note']" placeholder="ä¾‹å¦‚ï¼š99æ–° / ç”µæ± 85% / åœ¨ä¿" @input="autoName" />
					</view>
				</view>
			</view>
			
			<view class="grid-container mt-2">
				<view class="grid-cell" style="width: 100%;">
					<text class="field-label">å•†å“åç§° <text class="req">*</text></text>
					<input class="input-box font-bold bg-gray" v-model="form['name']" placeholder="å¡«å†™é…ç½®è‡ªåŠ¨ç”Ÿæˆ..." />
				</view>
			</view>
		</view>

		<view class="form-card">
			<view class="card-header-line">
				<view class="purple-bar"></view>
				<text class="header-text">æˆæœ¬ä¸æ”¯ä»˜ (å•ä»·)</text>
			</view>
			
			<view class="grid-container">
				<view class="grid-cell">
					<text class="field-label">å•ä¸ªæˆæœ¬ (Â¥) <text class="req">*</text></text>
					<input class="input-box font-bold text-red" type="digit" v-model="form['cost_price']" placeholder="0.00" />
				</view>
				<view class="grid-cell">
					<text class="field-label">å®ä»˜æ€»é¢ (Â¥)</text>
					<input class="input-box font-bold" type="digit" v-model="form['paid_amount']" placeholder="0 (æŒ‚è´¦)" />
				</view>
			</view>
			<view class="grid-container mt-2" v-if="showAccountSelect">
				<view class="grid-cell" style="width: 100%;">
					<text class="field-label">ä»˜æ¬¾è´¦æˆ·</text>
					<picker mode="selector" :range="accountNames" @change="onAccountChange" class="picker-full">
						<view class="input-box picker-layout">
							<text class="input-val text-dark">{{ currentAccountName }}</text>
							<text class="icon-arrow">â–¼</text>
						</view>
					</picker>
				</view>
			</view>
			<view class="status-tip" v-if="debtAmount > 0">
				<text class="tip-text text-red">âš ï¸ å‰©ä½™ Â¥{{ debtAmount.toFixed(2) }} è®¡å…¥åº”ä»˜è´¦æ¬¾</text>
			</view>
			<view class="grid-container mt-3 pt-3 border-top">
				<view class="grid-cell">
					<text class="field-label">åŒè¡Œåº•ä»· (Â¥)</text>
					<input class="input-box" type="digit" v-model="form['peer_price']" placeholder="é€‰å¡«" />
				</view>
				<view class="grid-cell">
					<text class="field-label">é›¶å”®æŒ‡å¯¼ (Â¥)</text>
					<input class="input-box" type="digit" v-model="form['retail_price']" placeholder="é€‰å¡«" />
				</view>
			</view>
		</view>
		
		<view class="placeholder-bottom"></view>
	</scroll-view>

	<view class="fixed-footer">
		<button class="btn-submit" :loading="loading" @click="submit">
			{{ form['quantity'] > 1 ? `æ‰¹é‡å…¥åº“ (${form['quantity']}ä»¶)` : 'ç¡®è®¤å…¥åº“å­˜æ¡£' }}
		</button>
	</view>

	<view v-if="showAddModal" class="modal-mask" style="z-index: 9999;"><view class="modal-center"><view class="modal-title">æ–°å¢ä¾›åº”å•†</view><input class="modal-input" v-model="newContact['name']" placeholder="å§“å (å¿…å¡«)" /><input class="modal-input" v-model="newContact['phone']" placeholder="ç”µè¯" type="number" /><input class="modal-input" v-model="newContact['address']" placeholder="åœ°å€/æ¡£å£" /><view class="modal-btns"><view class="modal-btn cancel" @click="showAddModal=false">å–æ¶ˆ</view><view class="modal-btn confirm" @click="addContact">ä¿å­˜</view></view></view></view>
	<view v-if="showSuccess" class="modal-mask" style="z-index: 9999;"><view class="modal-center"><view class="success-icon">âœ…</view><view class="modal-title">{{ form['quantity']>1 ? 'æ‰¹é‡å…¥åº“æˆåŠŸ' : 'å…¥åº“æˆåŠŸ' }}</view><view class="code-box"><text class="code-label">ç³»ç»Ÿç¼–ç </text><text class="code-val">{{ result['zencode'] }}</text></view><view class="name-box"><text class="name-val">{{ result['name'] }}</text></view><button class="btn-primary" @click="resetForm">ç»§ç»­ä¸‹ä¸€å•</button></view></view>
</template>

<script>
	import { request } from '@/common/api.js';
	const UPLOAD_URL = 'https://erp.corezen.site/api/products/'; // ğŸŸ¢ è¯·ç¡®è®¤æ­¤åŸŸåæ­£ç¡®

	export default {
		data() {
			return {
				loading: false,
				types: [ { key: 'ZJ', name: 'ç”µè„‘ä¸»æœº' }, { key: 'PH', name: 'æ‰‹æœº' }, { key: 'TB', name: 'å¹³æ¿' }, { key: 'XS', name: 'æ˜¾ç¤ºå™¨' }, { key: 'SJ', name: 'æ•£ä»¶' }, { key: 'ZX', name: 'æ‚é¡¹' } ],
				
				// ğŸŸ¢ æ ¸å¿ƒä¿®æ”¹ï¼šæ–°å¢ quantity å’Œ need_sn
				form: { 
					category: 'ZJ', supplier_id: '', name: '', sn: '', 
					cpu: '', gpu: '', ram: '', disk: '', note: '', 
					cost_price: '', paid_amount: '', account_id: '', 
					peer_price: '', retail_price: '',
					quantity: 1,      // é»˜è®¤1ä»¶
					need_sn: false    // é»˜è®¤ä¸éœ€è¦åºåˆ—å·
				},
				
				contacts: [], accounts: [], contactNames: ['åŠ è½½ä¸­...'], accountNames: [], currentContactName: 'è¯·é€‰æ‹©...', currentAccountName: 'é€‰æ‹©æ”¯ä»˜è´¦æˆ·', previewUrl: '', tempFilePath: '', showSuccess: false, showAddModal: false, result: { zencode: '', name: '', has_price: true }, newContact: { name: '', phone: '', address: '' },
				snPlaceholder: 'é€‰å¡«ï¼Œç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ'
			}
		},
		computed: {
			debtAmount(): number { 
				// ğŸŸ¢ æ¬ æ¬¾è®¡ç®—ï¼š(å•ä»· * æ•°é‡) - å·²ä»˜
				let cost = parseFloat(this.form['cost_price'] || '0');
				let num = parseInt(this.form['quantity'] || '1');
				let paid = parseFloat(this.form['paid_amount'] || '0'); 
				return (cost * num) - paid; 
			},
			showAccountSelect(): boolean { let paid = parseFloat(this.form['paid_amount'] || '0'); return paid > 0; },
			labelCPU(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'å“ç‰Œ (Brand)'; if(c=='XS') return 'å“ç‰Œ'; return 'CPU'; },
			phCPU(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'å¦‚ Apple'; if(c=='XS') return 'å¦‚ ä¸‰æ˜Ÿ'; return 'i5-12400F'; },
			labelGPU(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'é¢œè‰²/ç‰ˆæœ¬'; if(c=='XS') return 'é¢æ¿ç±»å‹'; return 'æ˜¾å¡ (ç©º=æ ¸æ˜¾)'; },
			phGPU(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'é»‘è‰² / å›½è¡Œ'; if(c=='XS') return 'IPS / VA'; return 'RTX3060'; },
			labelRAM(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'å‹å· (Model)'; if(c=='XS') return 'å°ºå¯¸'; return 'å†…å­˜'; },
			phRAM(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'iPhone 15'; if(c=='XS') return '27è‹±å¯¸'; return '16G'; },
			labelDISK(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return 'å®¹é‡'; if(c=='XS') return 'åˆ·æ–°ç‡'; return 'ç¡¬ç›˜'; },
			phDISK(): string { const c = this.form['category']; if(c=='PH'||c=='TB') return '256G'; if(c=='XS') return '144Hz'; return '512G'; }
		},
		onLoad() { this.loadData(); },
		methods: {
			async loadData() {
				try {
					const resC = await request({ url: '/api/contacts/?page_size=1000' });
					const resA = await request({ url: '/api/analysis/accounting/' });
					if (resC) { let list = resC['results'] || resC; this.contacts = list; this.contactNames = ['ğŸ›’ æ•£å®¢ (æ— ä¾›åº”å•†)']; this.contactNames.push(...this.contacts.map(c => c['name'])); }
					if (resA) { this.accounts = resA['accounts']; this.accountNames = this.accounts.map(a => a['name']); if (this.accounts.length > 0) { this.form['account_id'] = this.accounts[0]['id']; this.currentAccountName = this.accounts[0]['name']; } }
				} catch (e) {}
			},
			changeCategory(key) {
				this.form['category'] = key;
				// ğŸŸ¢ æ‰‹æœºå¹³æ¿é»˜è®¤å¼€å¯åºåˆ—å·
				if (key === 'PH' || key === 'TB') {
					this.form['need_sn'] = true;
				} else {
					this.form['need_sn'] = false;
				}
				this.updateSnPlaceholder();
				this.autoName();
			},
			// ğŸŸ¢ ç›‘å¬å¼€å…³
			onSnChange(e) {
				this.form['need_sn'] = e.detail.value;
				this.updateSnPlaceholder();
			},
			updateSnPlaceholder() {
				if (this.form['need_sn']) {
					this.snPlaceholder = 'ğŸ“± å¿…é¡»å¡«å†™ IMEI (å…¥åº“åéœ€æ‰«ç )';
				} else {
					this.snPlaceholder = 'é€‰å¡«ï¼Œç•™ç©ºè‡ªåŠ¨ç”Ÿæˆæµæ°´å·';
				}
			},
			scanCode() {
				uni.scanCode({
					success: (res) => {
						this.form['sn'] = res.result;
						uni.showToast({ title: 'å·²æ‰«ç ', icon: 'success' });
					}
				});
			},
			autoName() {
				const c = this.form['category'];
				if (c == 'SJ' || c == 'ZX') return;
				let parts = [];
				let v1 = this.form['cpu']; let v2 = this.form['ram']; let v3 = this.form['disk']; let v4 = this.form['gpu']; let note = this.form['note'];
				if (c == 'PH' || c == 'TB') { if(v1) parts.push(v1); if(v2) parts.push(v2); if(v3) parts.push(v3); if(v4) parts.push(v4); if(note) parts.push(note); } 
				else if (c == 'XS') { if(v1) parts.push(v1); if(v2) parts.push(v2); if(v3) parts.push(v3); if(v4) parts.push(v4); if(note) parts.push(note); } 
				else { if(v1) parts.push(v1); if(v2) parts.push(v2); if(v3) parts.push(v3); if (v4) { parts.push(v4); } else if (v1) { parts.push("æ ¸æ˜¾ä¸»æœº"); } if(note) parts.push(note); }
				this.form['name'] = parts.join(' ');
			},
			onContactChange(e) { let index = e.detail.value; if (index == 0) { this.form['supplier_id'] = '0'; this.currentContactName = 'ğŸ›’ æ•£å®¢'; } else { let contact = this.contacts[index - 1]; this.form['supplier_id'] = contact['id']; this.currentContactName = contact['name']; } },
			onAccountChange(e) { let index = e.detail.value; let acc = this.accounts[index]; this.form['account_id'] = acc['id']; this.currentAccountName = acc['name']; },
			chooseImage() { uni.chooseImage({ count: 1, sizeType: ['compressed'], success: (res) => { this.tempFilePath = res.tempFilePaths[0]; this.previewUrl = res.tempFilePaths[0]; } }); },
			async addContact() { if (!this.newContact['name']) return uni.showToast({title:'å§“åå¿…å¡«', icon:'none'}); try { const res = await request({ url: '/api/contacts/', method: 'POST', data: this.newContact }); uni.showToast({title:'æ·»åŠ æˆåŠŸ'}); this.showAddModal = false; this.newContact = { name:'', phone:'', address:'' }; await this.loadData(); if (res && res['id']) { this.form['supplier_id'] = res['id']; this.currentContactName = res['name']; } } catch (e) {} },
			async submit() { 
				if (!this.form['supplier_id']) return uni.showToast({title:'å¿…é¡»é€‰ä¾›åº”å•†', icon:'none'});
				if (!this.form['cost_price']) return uni.showToast({title:'è¯·å¡«å…¥åº“æˆæœ¬', icon:'none'});
				// ğŸŸ¢ æ ¡éªŒä¼˜åŒ–ï¼šå¦‚æœæ˜¯å•ä¸ªå…¥åº“ä¸”å¿…é¡»SNï¼Œæ‰æ ¡éªŒSN
				if (this.form['quantity'] == 1 && this.form['need_sn'] && !this.form['sn']) return uni.showToast({title:'è¯·å¡«å†™/æ‰«æåºåˆ—å·', icon:'none'});
				
				this.loading = true; 
				let formData = JSON.parse(JSON.stringify(this.form));
				
				const doRequest = async () => {
					try { 
						const res = await request({ url: '/api/products/', method: 'POST', data: formData });
						this.loading = false;
						if (res) this.handleSuccess(res); 
					} catch(e) { this.loading = false; }
				};
				if (this.tempFilePath) { 
					const sessionId = uni.getStorageSync('sessionid');
					uni.uploadFile({ url: UPLOAD_URL, filePath: this.tempFilePath, name: 'image', formData: formData, header: { 'Cookie': sessionId ? `sessionid=${sessionId}` : '' }, success: (uploadRes) => { this.loading = false; if (uploadRes.statusCode == 201 || uploadRes.statusCode == 200) { let data = JSON.parse(uploadRes.data); this.handleSuccess(data); } else { uni.showToast({title:'ä¸Šä¼ å¤±è´¥', icon:'none'}); } }, fail: () => { doRequest(); } });
				} else { doRequest(); } 
			},
			handleSuccess(data) { this.result['zencode'] = data['zencode']; this.result['name'] = data['name']; let hasPeer = !!this.form['peer_price']; let hasRetail = !!this.form['retail_price']; this.result['has_price'] = hasPeer || hasRetail; this.showSuccess = true; },
			resetForm() { 
				this.showSuccess = false;
				let cat = this.form['category']; let sup = this.form['supplier_id']; let acc = this.form['account_id'];
				// é‡ç½®è¡¨å•ï¼Œä¿ç•™å¿…è¦ä¿¡æ¯
				this.form = { 
					category: cat, supplier_id: sup, name: '', sn: '', 
					cpu: '', gpu: '', ram: '', disk: '', note: '', 
					cost_price: '', paid_amount: '', account_id: acc, 
					peer_price: '', retail_price: '',
					quantity: 1,      // ğŸŸ¢ é‡ç½®ä¸º1
					need_sn: this.form['need_sn'] // ğŸŸ¢ ä¿æŒå¼€å…³çŠ¶æ€
				};
				this.previewUrl = ''; this.tempFilePath = ''; this.changeCategory(cat); 
			}
		}
	}
</script>

<style>
	/* ...æ ·å¼ä¿æŒä¸å˜ï¼Œæ–°å¢éƒ¨åˆ†... */
	.page { padding: 30rpx; background-color: #f8fafc; height: 100vh; box-sizing: border-box; }
	.form-card { background-color: #fff; border-radius: 20rpx; padding: 30rpx; margin-bottom: 30rpx; box-shadow: 0 4rpx 10rpx rgba(0,0,0,0.02); }
	.card-header-line { display: flex; flex-direction: row; align-items: center; margin-bottom: 30rpx; }
	.blue-bar { width: 8rpx; height: 32rpx; background-color: #2563eb; border-radius: 4rpx; margin-right: 16rpx; }
	.purple-bar { width: 8rpx; height: 32rpx; background-color: #9333ea; border-radius: 4rpx; margin-right: 16rpx; }
	.orange-bar { width: 8rpx; height: 32rpx; background-color: #f59e0b; border-radius: 4rpx; margin-right: 16rpx; }
	.header-text { font-size: 32rpx; font-weight: bold; color: #1e293b; }
	.grid-container { display: flex; flex-direction: row; justify-content: space-between; width: 100%; gap: 20rpx; }
	.grid-cell { flex: 1; display: flex; flex-direction: column; }
	.mt-2 { margin-top: 20rpx; } .mb-3 { margin-bottom: 30rpx; }
	.field-label { font-size: 26rpx; font-weight: bold; color: #64748b; margin-bottom: 12rpx; display: block; }
	.req { color: #ef4444; margin-left: 4rpx; }
	.input-box { width: 100%; height: 90rpx; background-color: #fff; border: 1px solid #cbd5e1; border-radius: 16rpx; padding: 0 20rpx; font-size: 30rpx; color: #333; box-sizing: border-box; display: flex; align-items: center; }
	.bg-gray { background-color: #f8fafc; }
	.picker-full { width: 100%; }
	.picker-layout { display: flex; flex-direction: row; justify-content: space-between; align-items: center; }
	.input-val { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
	.text-dark { color: #333; } .text-light { color: #94a3b8; } .text-blue { color: #2563eb; }
	.icon-arrow { font-size: 24rpx; color: #cbd5e1; margin-left: 10rpx; font-weight: bold; }
	.row-center { display: flex; flex-direction: row; align-items: center; gap: 20rpx; }
	.flex-1 { flex: 1; }
	.add-btn { width: 80rpx; height: 90rpx; background-color: #eff6ff; border: 1px solid #bfdbfe; border-radius: 16rpx; display: flex; align-items: center; justify-content: center; color: #2563eb; font-size: 40rpx; font-weight: bold; }
	.type-cell { flex: 1; }
	.type-btn { height: 80rpx; display: flex; align-items: center; justify-content: center; border-radius: 16rpx; transition: all 0.2s; }
	.btn-active { background-color: #2563eb; box-shadow: 0 4rpx 10rpx rgba(37,99,235,0.3); }
	.btn-normal { background-color: #f1f5f9; }
	.type-text { font-size: 28rpx; font-weight: bold; }
	.text-white { color: #fff; } .text-gray { color: #64748b; }
	.upload-box { height: 300rpx; background-color: #f8fafc; border: 2px dashed #cbd5e1; border-radius: 20rpx; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 30rpx; position: relative; }
	.upload-placeholder { display: flex; flex-direction: column; align-items: center; }
	.camera-icon { font-size: 60rpx; margin-bottom: 10rpx; color: #94a3b8; }
	.camera-text { font-size: 26rpx; color: #94a3b8; font-weight: bold; }
	.upload-img { width: 100%; height: 100%; }
	.placeholder-bottom { height: 180rpx; }
	.fixed-footer { position: fixed; bottom: 0; left: 0; right: 0; background-color: #fff; padding: 20rpx 30rpx 60rpx 30rpx; box-shadow: 0 -4rpx 20rpx rgba(0,0,0,0.05); z-index: 100; }
	.btn-submit { background-color: #9333ea; color: #fff; height: 100rpx; line-height: 100rpx; border-radius: 20rpx; font-size: 34rpx; font-weight: bold; border: none; width: 100%; }
	.font-bold { font-weight: bold; } .text-red { color: #ef4444; } .text-green { color: #16a34a; }
	.status-tip { margin-top: 20rpx; background-color: #fff7ed; padding: 16rpx; border-radius: 12rpx; border: 1px solid #ffedd5; }
	.bg-green-light { background-color: #f0fdf4; border-color: #dcfce7; }
	.tip-text { font-size: 24rpx; font-weight: bold; }
	.border-top { border-top: 1px solid #f1f5f9; }
	.pt-3 { padding-top: 30rpx; }
	.sn-box { background-color: #fffbeb; border: 1px solid #fcd34d; border-radius: 16rpx; padding: 20rpx; margin-bottom: 30rpx; }
	.sn-input-wrapper { display: flex; flex-direction: row; margin-top: 10rpx; gap: 10rpx; }
	.sn-input { flex: 1; height: 80rpx; background-color: #fff; border: 1px solid #fcd34d; border-radius: 12rpx; padding: 0 20rpx; font-size: 30rpx; }
	.scan-btn { width: 100rpx; height: 80rpx; background-color: #f59e0b; color: #fff; display: flex; align-items: center; justify-content: center; border-radius: 12rpx; font-weight: bold; }
	.bg-blue-light { background-color: #eff6ff; border: 1px solid #bfdbfe; }
	/* å¼¹çª—æ ·å¼ */
	.modal-mask { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.6); z-index: 999; display: flex; align-items: center; justify-content: center; }
	.modal-center { background-color: #fff; width: 600rpx; border-radius: 24rpx; padding: 40rpx; display: flex; flex-direction: column; }
	.modal-title { text-align: center; font-size: 34rpx; font-weight: bold; margin-bottom: 30rpx; }
	.modal-input { background-color: #f8fafc; height: 90rpx; border-radius: 12rpx; padding: 0 24rpx; margin-bottom: 24rpx; font-size: 30rpx; border: 1px solid #e2e8f0; }
	.modal-btns { display: flex; flex-direction: row; justify-content: space-between; margin-top: 10rpx; gap: 20rpx; }
	.modal-btn { flex: 1; height: 80rpx; line-height: 80rpx; text-align: center; border-radius: 12rpx; font-size: 30rpx; font-weight: bold; }
	.cancel { background-color: #f1f5f9; color: #64748b; }
	.confirm { background-color: #2563eb; color: #fff; }
	.success-icon { font-size: 80rpx; text-align: center; margin-bottom: 20rpx; }
	.code-box { background-color: #eff6ff; padding: 24rpx; border-radius: 16rpx; text-align: center; margin-bottom: 20rpx; width: 100%; box-sizing: border-box; }
	.code-label { font-size: 24rpx; color: #60a5fa; display: block; margin-bottom: 8rpx; }
	.code-val { font-size: 40rpx; font-weight: 900; color: #1e40af; font-family: monospace; }
	.name-box { width: 100%; padding: 20rpx 0; border-bottom: 1px dashed #e2e8f0; margin-bottom: 30rpx; text-align: center; }
	.name-val { font-size: 30rpx; font-weight: bold; color: #333; }
	.warn-box { background-color: #fff7ed; padding: 16rpx; border-radius: 12rpx; margin-bottom: 30rpx; width: 100%; box-sizing: border-box; text-align: center; }
	.warn-text { font-size: 24rpx; color: #ea580c; }
	.btn-primary { background-color: #2563eb; color: #fff; width: 100%; height: 90rpx; line-height: 90rpx; border-radius: 16rpx; font-size: 32rpx; font-weight: bold; border: none; }
</style>